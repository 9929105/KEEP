// Generated by CoffeeScript 1.6.1

$(function() {
  return $.getJSON('/api/v1/data/', {
    'user': $('#user').html()
  }, function(data) {
    var datum, feed_tmpl, info, _i, _len, _results;
    console.log(moment().format());
    $('#submissions_feed').html('');
    if (data.length === 0) {
      return $('#submissions_feed').html('<div style="color:#AAA;">No submissions yet =[</div>');
    } else {
      feed_tmpl = _.template($('#submission_feed_tmpl').html());
      _results = [];
      for (_i = 0, _len = data.length; _i < _len; _i++) {
        datum = data[_i];
        info = {
          label: 'submission received',
          time: moment.utc(datum.timestamp).fromNow(),
          link: "/api/v1/data/" + datum.survey
        };
        _results.push($('#submissions_feed').append(feed_tmpl(info)));
      }
      return _results;
    }
  });
});
